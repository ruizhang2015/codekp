<?xml version="1.0" encoding="UTF-8"?>
<BugPattern> 
	<Description>Magic Quotes Related Bugs</Description>
	<ErrorMessage>Misuse of on {0}</ErrorMessage>
	<ObjectSensitive>true</ObjectSensitive>
	<Severity>3</Severity>
	
	<FeaturedObjects>
		<FeaturedObject Type="ClientInputData"></FeaturedObject>
	</FeaturedObjects>
	
	<FeaturedStatements>
		<Statement Type="GetInternalDataBy_GET"></Statement>
		<Statement Type="GetInternalDataBy_POST"></Statement>
		<Statement Type="Assignment">
			<RightExpression>
				<Statement Type="MethodCall">
					<RegularExpression>stripSlashes(*,*)</RegularExpression>
				</Statement>
			</RightExpression>
		</Statement>
		<Statement Type="Assignment">
			<RightExpression>
				<Statement Type="MethodCall">
					<RegularExpression>addSlashes(*,*)</RegularExpression>
				</Statement>
			</RightExpression>
		</Statement>
		<Statement UsageType="DatabaseQuery"></Statement>
		<Statement UsageType="EmailOutput"></Statement>
		<Statement UsageType="HTMLOutput"></Statement>
		<Statement UsageType="JSONDecode"></Statement>
		<Statement UsageType="EchoOutput"></Statement>
		<Statement UsageType="GUIOutput"></Statement>
		<Statement UsageType="FileOutput"></Statement>
		<Statement UsageType="WordPressEncoding"></Statement>
		<Statement UsageType="JSONDecode"></Statement>
		<Statement UsageType="EchoOutput"></Statement>
		<Statement UsageType="GUIOutput"></Statement>
		<Statement UsageType="FileOutput"></Statement>
		<Statement UsageType="WordPressEncoding"></Statement>
		<Statement UsageType="PageOutput"></Statement>
	</FeaturedStatements>
	
	<UsageScenarios>
		<State>
			<ID>1</ID >
			<InitialState>true</InitialState>
			<ExceptionalState>1</ExceptionalState>
			<Event>
				<Precondition>magic_quotes.* == uncertain</Precondition>
				<Statements>
					<Statement Type="GetInternalDataBy_GET"></Statement>
					<Statement Type="GetInternalDataBy_POST"></Statement>
				<Statements>
				<CurrentObject inputParameter="false" returnValue="true"></CurrentObject>
				<ToPushObject inputParameter="false" returnValue="true"></CurrentObject>
				<ToState>2</ToState>
			</Event>
			<Event>
				<Precondition>magic_quotes.* == false</Precondition>
				<Statements>
					<Statement Type="GetInternalDataBy_GET"></Statement>
					<Statement Type="GetInternalDataBy_POST"></Statement>
				<Statements>
				<CurrentObject><outputParameter></outputParameter></CurrentObject>
				<ToPushObject><outputParameter></outputParameter></CurrentObject>
				<ToState>3</ToState>	
			</Event>
			<Event>
				<Precondition>magic_quotes.* == true</Precondition>
				<Statements>
					<Statement Type="GetInternalDataBy_GET"></Statement>
					<Statement Type="GetInternalDataBy_POST"></Statement>
				<Statements>
				<CurrentObject><outputParameter></outputParameter></CurrentObject>
				<ToPushObject><outputParameter></outputParameter></CurrentObject>
				<ToState>4</ToState>	
			</Event>
		</State>
		<State>
			<ID>2</ID>
			<ExceptionalState>2</ExceptionalState>
			<Event>
				<Precondition>magic_quotes.* == uncertain</Precondition>
				<Statements>
					<Statement Type="If">
						<RegularExpression>.*magic_quotes.* == false.*</RegularExpression>
					</Statement>
				<Statements>
				<ToState>3</ToState>
			</Event>
			<Event>
				<Precondition>magic_quotes.* == uncertain</Precondition>
				<Statements>
					<Statement Type="If">
						<RegularExpression>.*magic_quotes.* == true.*</RegularExpression>
					</Statement>
				<Statements>
				<ToState>4</ToState>
			</Event>
		</State>
		<State>
			<ID>3</ID>
			<ExceptionalState>3</ExceptionalState>
			<Event>
				<Statements>
					<Statement Type="Assignment">
						<RightExpression>
							<Statement Type="MethodCall">
								<RegularExpression>addSlashes(*,*)</RegularExpression>
							</Statement>
						</RightExpression>
					</Statement>
				<Statements>
				<CurrentObject><inputParameter>1</inputParameter></CurrentObject>
				<ToPushObject><outputParameter></outputParameter></CurrentObject>
				<ToState>4</ToState>
			</Event>
			<Event>
				<Statements>
					<Statement UsageType="DatabaseQuery"></Statement>
					<Statement UsageType="EmailOutput"></Statement>
					<Statement UsageType="HTMLOutput"></Statement>
				<Statements>
				<ToState>6</ToState>
			</Event>
		</State>
		<State>
			<ID>4</ID>
			<ExceptionalState>4</ExceptionalState>
			<Event>
				<Statements>
					<Statement Type="Assignment">
						<RightExpression>
							<Statement Type="MethodCall">
								<RegularExpression>stripSlashes(*,*)</RegularExpression>
							</Statement>
						</RightExpression>
					</Statement>
				<Statements>
				<CurrentObject><inputParameter>1</inputParameter></CurrentObject>
				<ToPushObject><outputParameter></outputParameter></CurrentObject>
				<ToState>4</ToState>
			</Event>
			<Event>
				<Statements>
					<Statement Type="Assignment">
						<RightExpression>
							<Statement Type="MethodCall">
								<RegularExpression>addSlashes(*,*)</RegularExpression>
							</Statement>
						</RightExpression>
					</Statement>
				<Statements>
				<CurrentObject><inputParameter>1</inputParameter></CurrentObject>
				<ToPushObject><outputParameter></outputParameter></CurrentObject>
				<ToState>5</ToState>
			</Event>
			<Event>
				<Statements>
					<Statement UsageType="JSONDecode"></Statement>
					<Statement UsageType="EchoOutput"></Statement>
					<Statement UsageType="GUIOutput"></Statement>
					<Statement UsageType="FileOutput"></Statement>
					<Statement UsageType="WordPressEncoding"></Statement>
				<Statements>
				<ToState>6</ToState>
			</Event>
		</State>
		<State>
			<ID>5</ID>
			<ExceptionalState>5</ExceptionalState>
			<Event>
				<Statements>
					<Statement Type="Assignment">
						<RightExpression>
							<Statement Type="MethodCall">
								<RegularExpression>stripSlashes(*,*)</RegularExpression>
							</Statement>
						</RightExpression>
					</Statement>
				<Statements>
				<CurrentObject><inputParameter>1</inputParameter></CurrentObject>
				<ToPushObject><outputParameter></outputParameter></CurrentObject>
				<ToState>4</ToState>
			</Event>
			<Event>
				<Statements>
					<Statement UsageType="DatabaseQuery"></Statement>
					<Statement UsageType="EmailOutput"></Statement>
					<Statement UsageType="HTMLOutput"></Statement>
				<Statements>
				<ToState>6</ToState>
			</Event>
			<Event>
				<Statements>
					<Statement UsageType="JSONDecode"></Statement>
					<Statement UsageType="EchoOutput"></Statement>
					<Statement UsageType="GUIOutput"></Statement>
					<Statement UsageType="FileOutput"></Statement>
					<Statement UsageType="WordPressEncoding"></Statement>
					<Statement UsageType="PageOutput"></Statement>
				<Statements>
				<ToState>6</ToState>
			</Event>
		</State>
		<State>
			<ID>6</ID>
			<ExceptionalState>6</ExceptionalState>
			<Status>Buggy</Status>
		</State>
	</UsageScenarios>
</BugPattern>